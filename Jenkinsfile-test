pipeline{
    agent any
    tools{
        maven "Maven-3.9.10"
    }
    stages{
        stage("TEST"){
            steps{
                sh "mvn test"
            }
        }
        stage("BUILD"){
            steps{
                sh "mvn package"
            }
        }
        stage("DEPLOY_TO_TEST"){
            steps{
                deploy adapters: [tomcat9(alternativeDeploymentContext: '', credentialsId: 'ba67d9f6-23cc-4aea-acd2-54dfe5882425', path: '', url: 'http://192.168.29.207:8080')], contextPath: '/app', war: '**/*.war'
            }
        }
        stage("Approval"){
            steps{
                input message: "Do you want to proceed?"
                ok: "Yes, proceed"
            }
        }
        stage("DEPLOY_TO_PROD"){
            steps{
                deploy adapters: [tomcat9(alternativeDeploymentContext: '', credentialsId: 'ba67d9f6-23cc-4aea-acd2-54dfe5882425', path: '', url: 'http://192.168.29.173:8080')], contextPath: '/app', war: '**/*.war'
            }
        }
    }
    post{
        always{
            echo "========always========"
        }
        success{
            echo "========pipeline executed successfully ========"
        }
        failure{
            echo "========pipeline execution failed========"
        }
    }
}
